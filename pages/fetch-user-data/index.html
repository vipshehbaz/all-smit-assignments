<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Catalog | SMIT</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Inter", sans-serif;
    }

    body {
      background-color: #f8f9fa;
      color: #2d3436;
    }

    main {
      max-width: 1440px;
      width: 95%;
      margin: auto;
      padding: 2rem 0;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      font-size: 1rem;
      text-decoration: none;
      color: #6c5ce7;
      font-weight: 500;
      transition: all 0.3s ease;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      background-color: rgba(108, 92, 231, 0.1);
    }

    .back-link:hover {
      background-color: rgba(108, 92, 231, 0.2);
      transform: translateX(-5px);
    }

    h2 {
      font-size: 2rem;
      font-weight: 700;
      color: #2d3436;
      text-align: center;
      margin-bottom: 2rem;
    }

    .filters {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }

    select {
      padding: 0.75rem 1rem;
      border: 1px solid #dfe6e9;
      border-radius: 8px;
      font-size: 0.9rem;
      color: #2d3436;
      background-color: white;
      min-width: 200px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    select:hover {
      border-color: #6c5ce7;
    }

    select:focus {
      outline: none;
      border-color: #6c5ce7;
      box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.1);
    }

    .container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 2rem;
      margin-top: 2rem;
    }

    .card {
      background: white;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      height: 100%;
      cursor: pointer;
      text-decoration: none;
      color: inherit;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
    }

    .card-image {
      width: 100%;
      height: 250px;
      object-fit: contain;
      border-bottom: 1px solid #f1f2f6;
    }

    .card-content {
      padding: 1.5rem;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .brand {
      display: inline-block;
      background-color: rgba(108, 92, 231, 0.1);
      color: #6c5ce7;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
      width: fit-content;
    }

    .heading {
      font-size: 1.25rem;
      font-weight: 600;
      color: #2d3436;
      line-height: 1.4;
      margin-bottom: 0.5rem;
    }

    .description {
      font-size: 0.9rem;
      color: #636e72;
      line-height: 1.6;
      margin-bottom: 0.5rem;
    }

    .rating {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
      color: #636e72;
    }

    .rating::before {
      content: "★";
      color: #fdcb6e;
    }

    .price-container {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin: 0.5rem 0;
    }

    .close-price {
      color: #b2bec3;
      text-decoration: line-through;
      font-size: 0.9rem;
    }

    .open-price {
      color: #00b894;
      font-weight: 600;
      font-size: 1.1rem;
    }

    .category {
      font-size: 0.9rem;
      color: #636e72;
      margin-top: auto;
    }

    .tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    .tag {
      background-color: #f1f2f6;
      color: #636e72;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      font-size: 0.8rem;
    }

    @media (max-width: 768px) {
      .container {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      }

      .filters {
        flex-direction: column;
      }

      select {
        width: 100%;
      }
    }

    .search-container {
      margin-bottom: 2rem;
    }

    .search-input {
      width: 100%;
      padding: 1rem;
      border: 1px solid #dfe6e9;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: #6c5ce7;
      box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.1);
    }
  </style>
  <body>
    <main>
      <div class="header">
        <a href="/index.html" class="back-link">← Back to Home</a>
      </div>
      <h2>Product Catalog</h2>
      <div class="search-container">
        <input
          type="text"
          class="search-input"
          placeholder="Search products..."
          id="searchInput"
        />
      </div>
      <div class="filters">
        <select name="filterWithBrand" id="filterWithBrand">
          <option value="">Filter by Brand</option>
        </select>
        <select name="filterWithCategory" id="filterWithCategory">
          <option value="">Filter by Category</option>
        </select>
      </div>
      <div class="container"></div>
    </main>
    <script>
      const container = document.querySelector(".container");
      const selectBrand = document.querySelector("#filterWithBrand");
      const selectCategory = document.querySelector("#filterWithCategory");
      let products = [];
      let categories = new Set();
      let brands = new Set();

      async function fetchProducts() {
        try {
          const response = await fetch("https://dummyjson.com/products");
          if (!response.ok) {
            throw new Error("Failed to fetch products");
          }
          const data = await response.json();
          products = data.products;
          displayProducts(products);
          setupFilters();
        } catch (error) {
          console.error("Error fetching products:", error);
          container.innerHTML =
            "<p>Error loading products. Please try again later.</p>";
        }
      }

      function displayProducts(productsToDisplay) {
        container.innerHTML = "";
        productsToDisplay.forEach((product) => {
          const newPrice =
            product.price - (product.price * product.discountPercentage) / 100;
          const card = `
            <a href="product.html?id=${product.id}" class="card">
              <img src="${product.thumbnail}" alt="${
            product.title
          }" class="card-image" />
              <div class="card-content">
                ${
                  product.brand
                    ? `<span class="brand">${product.brand}</span>`
                    : ""
                }
                <h3 class="heading">${product.title}</h3>
                <p class="description">${product.description}</p>
                <div class="rating">${product.rating.toFixed(1)}</div>
                <div class="price-container">
                  <span class="close-price">$${product.price.toFixed(2)}</span>
                  <span class="open-price">$${newPrice.toFixed(2)}</span>
                </div>
                <p class="category">${product.category}</p>
                <div class="tags">
                  ${product.tags
                    .map((tag) => `<span class="tag">${tag}</span>`)
                    .join("")}
                </div>
              </div>
            </a>`;
          container.innerHTML += card;
        });
      }

      function setupFilters() {
        products.forEach((product) => {
          if (product.category) categories.add(product.category);
          if (product.brand) brands.add(product.brand);
        });

        selectCategory.innerHTML =
          '<option value="">Filter by Category</option>';
        categories.forEach((category) => {
          selectCategory.innerHTML += `<option value="${category}">${category}</option>`;
        });

        selectBrand.innerHTML = '<option value="">Filter by Brand</option>';
        brands.forEach((brand) => {
          selectBrand.innerHTML += `<option value="${brand}">${brand}</option>`;
        });

        selectBrand.addEventListener("change", filterProducts);
        selectCategory.addEventListener("change", filterProducts);
      }
      function filterProducts() {
        const selectedBrand = selectBrand.value;
        const selectedCategory = selectCategory.value;
        const searchTerm = searchInput.value.toLowerCase();

        const filteredProducts = products.filter((product) => {
          const brandMatch = !selectedBrand || product.brand === selectedBrand;
          const categoryMatch =
            !selectedCategory || product.category === selectedCategory;
          const searchMatch =
            !searchTerm ||
            product.title.toLowerCase().includes(searchTerm) ||
            product.description.toLowerCase().includes(searchTerm) ||
            (product.brand &&
              product.brand.toLowerCase().includes(searchTerm)) ||
            product.category.toLowerCase().includes(searchTerm);

          return brandMatch && categoryMatch && searchMatch;
        });

        displayProducts(filteredProducts);
      }

      const searchInput = document.getElementById("searchInput");
      searchInput.addEventListener("input", filterProducts);

      fetchProducts();
    </script>
  </body>
</html>
